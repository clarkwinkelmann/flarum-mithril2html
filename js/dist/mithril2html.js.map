{"version":3,"file":"mithril2html.js","mappings":"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","sources":["webpack://mithril2html/webpack/bootstrap","webpack://mithril2html/webpack/runtime/compat get default export","webpack://mithril2html/webpack/runtime/define property getters","webpack://mithril2html/webpack/runtime/hasOwnProperty shorthand","webpack://mithril2html/webpack/runtime/make namespace object","webpack://mithril2html/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://mithril2html/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://mithril2html/external root \"flarum.core.compat['common/extend']\"","webpack://mithril2html/external root \"flarum.core.compat['forum/app']\"","webpack://mithril2html/external root \"flarum.core.compat['common/utils/mapRoutes']\"","webpack://mithril2html/external root \"flarum.core.compat['common/utils/Drawer']\"","webpack://mithril2html/external root \"flarum.core.compat['forum/utils/Pane']\"","webpack://mithril2html/external root \"flarum.core.compat['common/components/Page']\"","webpack://mithril2html/external root \"flarum.core.compat['forum/ForumApplication']\"","webpack://mithril2html/external root \"flarum.core.compat['common/components/Link']\"","webpack://mithril2html/./src/mithril2html/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/mapRoutes'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Drawer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/Pane'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/ForumApplication'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","import {Vnode} from 'mithril';\nimport {extend, override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport mapRoutes from 'flarum/common/utils/mapRoutes';\nimport Drawer from 'flarum/common/utils/Drawer';\nimport Pane from 'flarum/forum/utils/Pane';\nimport Page from 'flarum/common/components/Page';\nimport ForumApplication from 'flarum/forum/ForumApplication';\nimport Link from 'flarum/common/components/Link';\n\nclass Index extends Page {\n    view() {\n        return m('p', 'There was a problem rendering this content.');\n    }\n}\n\nclass NotFound extends Page {\n    view() {\n        return m('p', 'There was a problem rendering this content. The component was not found.');\n    }\n}\n\n// We override the mount method for two reasons\n// First, to use hashbang routing, which requires extending in Application instead of ForumApplication (or we could need to rewrite a lot)\n// Second, to remove unneeded features like modals/alerts/header\noverride(ForumApplication.prototype, 'mount', function (this: ForumApplication) {\n    this.pane = new Pane(document.getElementById('app'));\n\n    m.route.prefix = '#!';\n\n    // Has to be kept for compatibility\n    this.drawer = new Drawer();\n\n    // Apply our internal routes last\n    this.routes.index = {\n        path: '/',\n        component: Index,\n    };\n    this.routes.notFound = {\n        path: '/:404...',\n        component: NotFound,\n    };\n\n    console.info('Registered routes: ' + Object.keys(this.routes).map(routeName => routeName + ' (' + this.routes[routeName].path + ')').join(', '));\n\n    // Same as original, with added catch block\n    try {\n        m.route(document.getElementById('content'), '/', mapRoutes(this.routes));\n    } catch (error) {\n        console.log('A Flarum boot error occurred');\n        throw error;\n    }\n});\n\nextend(Link, 'initAttrs', function (returnValue: any, attrs: any) {\n    // If the URL is already fully qualified, don't change anything\n    if (/^https?:\\/\\//.test(attrs.href)) {\n        return;\n    }\n\n    // If the URL was relative, even if it was already external\n    // we compute the absolute URL before setting it back\n    const url = new URL(attrs.href, app.forum.attribute('baseUrl'));\n\n    attrs.href = url.href;\n    attrs.external = true;\n});\n\nextend(Link.prototype, 'view', function (vnode: Vnode<any>) {\n    // Flarum doesn't remove this element from the attrs before dumping in the DOM\n    // It's a bit stupid to keep it in the exported HTML (also, it simplifies the integration tests)\n    if (vnode && vnode.attrs) {\n        delete vnode.attrs.external;\n\n        // These 2 attributes often end up set via LinkButton\n        delete vnode.attrs.active;\n        delete vnode.attrs.force;\n\n        // Remove class attribute if empty to simplify HTML\n        if (typeof vnode.attrs.className === 'string' && vnode.attrs.className.trim() === '') {\n            delete vnode.attrs.className;\n        }\n    }\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","flarum","core","compat","Index","view","m","Page","NotFound","override","ForumApplication","this","pane","Pane","document","getElementById","route","prefix","drawer","Drawer","routes","index","path","component","notFound","console","info","keys","map","routeName","join","mapRoutes","error","log","extend","Link","returnValue","attrs","test","href","url","URL","app","external","vnode","active","force","className","trim"],"sourceRoot":""}